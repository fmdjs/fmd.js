fmd("combo",["cache","lang","event","config","module","assets","plugin","when","loader","preload"],function(n,t,e,u,i,o,r,c,s,f){var l=n.combo={},a="async",d="non",p="_combo",m="_combo_non",h="comboSyntax",g="comboMaxLength",v="fetch",y=/\.css(?:\?|$)/i,b=/((?:[\w]+)\:\/\/(?:[\w|\.|\:]+)\/)(.+)/i,_=["??",","],k=1500,x=function(n){var t=_[0],e=_[1];return t&&n.indexOf(t)>0||e&&n.indexOf(e)>0},q=function(n){return n.substring(n.lastIndexOf("."))},E=function(n,t){var e=n.match(b);t._host=e[1],t._path=e[2]},w=function(n){var t=n.url.split("?fmd.stamp")[0],e=q(t);return E(t,n),[e,n._host].join("_")},O=function(n,t){if(n.included.length>1||n.plugin===m)e.emit("stamp",n),l[n.url]=n,t.push(n);else{var u=n.included[0];delete u.requested}},j=function(n,t){return n.url+_[n.url===t._host?0:1]+t._path},S=function(n){if(!(2>n.length)){u.get(h)&&(_=u.get(h)),u.get(g)&&(k=u.get(g));for(var e,r,c=[],s=0;n.length>s;s++)e=n[s],e.plugin!==a&&e.plugin!==d||e.comboed||e.state||e.preState||(!y.test(e.url)||x(e.url)?e.url!==e.id?x(e.url)||c.push(e):(r=i.get(e.id),r&&!r.compiled&&t.forEach(r.deps,function(t){n.push(o.make(t))})):c.push(e));c.length&&z(c,n)}},z=function(n,e){var u,i,o,r,c={},s=function(n,t){var e=c[n]={url:t._host,plugin:p,included:[]};return e};t.forEach(n,function(n){u=w(n),i=c[u]||s(u,n),o=j(i,n),o.length>k&&(O(i,e),delete c[u],i=s(u,n),o=j(i,n)),i.url=o,i.included.push(n),n.plugin===d&&(i.plugin=m,n.plugin=a),n.comboed=!0,n.requested=!0});for(r in c)O(c[r],e)},C=function(n){t.forEach(n.included,function(n){e.emit("requestComplete",n)})},I=function(n){c.apply(null,t.map(this.group,function(n){return function(t){s(n,function(){C(n),t.resolve()})}})).then(n)},L=function(n){var e=this.group;f(e,function(){t.forEach(e,function(n){C(n)}),n()})};u.register({keys:"combo",rule:function(n,t,u){u=!!u,n!==u&&(this.combo=u,u===!0?(e.on(v,S),r.register(p,I),r.register(m,L)):(e.off(v,S),r.register(p,null),r.register(m,null)))}}).set({combo:!0})});