fmd("combo",["cache","lang","event","config","module","assets","plugin","when","loader","preload"],function(n,t,e,i,u,o,r,c,s,a){var f=n.combo={},l="async",d="non",m="_combo",p="_combo_non",h="comboSyntax",g="comboMaxLength",v="fetch",y=/\.css(?:\?|$)/i,b=/((?:[\w]+)\:\/\/(?:[\w|\.|\:]+)\/)(.+)/i,_=["??",","],k=1500,x=function(n){var t=_[0],e=_[1];return t&&n.indexOf(t)>0||e&&n.indexOf(e)>0},q=function(n){return n.substring(n.lastIndexOf("."))},E=function(n,t){var e=n.match(b);t._host=e[1],t._path=e[2]},w=function(n){var t=n.url.split("?fmd.stamp")[0],e=q(t);return E(t,n),[e,n._host].join("_")},O=function(n,t){if(n.included.length>1||n.plugin===p)e.emit("stamp",n),f[n.url]=n,t.push(n);else{var i=n.included[0];delete i.requested}},j=function(n,t){return n.url+_[n.url===t._host?0:1]+t._path},S=function(n){if(!(2>n.length)){i.get(h)&&(_=i.get(h)),i.get(g)&&(k=i.get(g));for(var e,r,c=[],s=0;n.length>s;s++)e=n[s],e.plugin!==l&&e.plugin!==d||e.comboed||e.state||e.preState||(!y.test(e.url)||x(e.url)?e.url!==e.id?x(e.url)||c.push(e):(r=u.get(e.id),r&&!r.compiled&&t.forEach(r.deps,function(t){n.push(o.make(t,r))})):c.push(e));c.length&&z(c,n)}},z=function(n,e){var i,u,o,r,c={},s=function(n,t){var e=c[n]={url:t._host,plugin:m,included:[]};return e};t.forEach(n,function(n){i=w(n),u=c[i]||s(i,n),o=j(u,n),o.length>k&&(O(u,e),delete c[i],u=s(i,n),o=j(u,n)),u.url=o,u.included.push(n),n.plugin===d&&(u.plugin=p,n.plugin=l),n.comboed=!0,n.requested=!0});for(r in c)O(c[r],e)},C=function(n){t.forEach(n.included,function(n){e.emit("requestComplete",n)})},I=function(n){c.apply(null,t.map(this.group,function(n){return function(t){s(n,function(){C(n),t.resolve()})}})).then(n)},L=function(n){var e=this.group;a(e,function(){t.forEach(e,function(n){C(n)}),n()})};i.register({keys:"combo",rule:function(n,t,i){i=!!i,n!==i&&(this.combo=i,i===!0?(e.on(v,S),r.register(m,I),r.register(p,L)):(e.off(v,S),r.register(m,null),r.register(p,null)))}}).set({combo:!0})});