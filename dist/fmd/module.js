fmd("module",["global","env","cache","lang","event"],function(e,k,n,g,d){var p=[],l=0,h=n.modules={},m={require:function(a){a.require||c.makeRequire(a);d.emit("makeRequire",a.require,a);return a.require},exports:function(a){return a.exports},module:function(a){a.module={id:a.id,exports:a.exports};return a.module}},c=function(a,b,c){this.id=a;this.deps=b||[];this.factory=c;this.exports={};this.unnamed()&&(a="_!_fmd_anonymous_"+l,l++);this.uid=a};c.prototype={unnamed:function(){return""===this.id},
extract:function(){var a=this,b=a.deps,f=[];g.isArray(b)&&g.forEach(b,function(b){var d;(d=m[b])?b=d(a):(a.require||c.makeRequire(a),b=a.require(b));f.push(b)});return f},compile:function(){try{if(g.isFunction(this.factory)){var a=this.extract(),b=this.factory.apply(null,a);void 0!==b?this.exports=b:this.module&&this.module.exports&&(this.exports=this.module.exports);this.module&&delete this.module}else void 0!==this.factory&&(this.exports=this.factory);d.emit("compiled",this)}catch(c){d.emit("compileFailed",
c,this)}},autocompile:function(){this.unnamed()&&this.compile()}};c.get=function(a){return h[a]};c.has=function(a,b){if(m[a])return!0;var c={id:a};b&&d.emit("alias",c);return h[c.id]?!0:!1};c.save=function(a){h[a.uid]=a;d.emit("saved",a);a.autocompile()};c.require=function(a){var b=c.get(a);if(!b)return d.emit("requireFailed",{id:a}),null;b.compiled||(b.compiled=!0,b.compile());d.emit("required",b);return b.exports};c.makeRequire=function(a){a.require=function(b){b={id:b};d.emit("relative",b,a);d.emit("alias",
b);return c.require(b.id)}};c.define=function(a,b,f){var e=arguments.length;1===e?(f=a,a=""):2===e&&(f=b,b=p,g.isString(a)||(b=a,a=""));if(c.has(a,!0))return d.emit("existed",{id:a}),null;c.save(new c(a,b,f))};var q=e.define;k.noConflict=function(){e.define=q};k.define=e.define=c.define;return c});
