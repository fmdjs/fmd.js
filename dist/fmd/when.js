fmd("when",function(){var e=function(){},n=function(n){var t=this,r=[],i=0,o=0;n=n||0;var u=function(){i+o===n&&c()},c=function(){t.then=o?function(e,n){n&&n()}:function(e){e&&e()},c=e,a(o?1:0),a=e,r=[]},a=function(e){for(var n,t,i=0;n=r[i++];)t=n[e],t&&t()};this.then=function(e,n){r.push([e,n])},this.resolve=function(){i++,u()},this.reject=function(){o++,u()},u()},t=function(){for(var e,t=arguments.length,r=new n(t),i=0;e=arguments[i++];)e(r);return r};return t});