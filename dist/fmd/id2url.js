fmd("id2url",["global","event","config"],function(e,n,t){var r=/^https?:\/\//i,i=(new Date).getTime(),u="resolve",o="stamp";t.set({baseUrl:function(){var n=/(?:[\w]+)\:\/\/(?:[\w|\.|\:]+)\//i,t=e.document.getElementsByTagName("script"),r=t[t.length-1],i=(r.hasAttribute?r.src:r.getAttribute("src",4)).match(n);return i[0]}()}),t.register({keys:u,name:"array"}).register({keys:o,name:"object"});var c=function(e){var n,r=t.get(u);if(r)for(var i=0,o=r.length;o>i&&(n=r[i](e.id),n===e.id);i++);e.url=n?n:e.id},s=function(e){r.test(e.url)||(e.url=t.get("baseUrl")+e.url)},a=function(e){var n=e.url;n.lastIndexOf(".")<n.lastIndexOf("/")&&(e.url+=".js")},l=function(e){var n=t.get("hasStamp")?i:null,r=t.get(o);if(r)for(var u in r)if(RegExp(u).test(e.id)){n=r[u];break}n&&(e.url+="?fmd.stamp="+n)},f=function(e){n.emit(u,e),s(e),a(e),n.emit(o,e)};n.on(u,c),n.on(o,l),n.on("id2url",f)});