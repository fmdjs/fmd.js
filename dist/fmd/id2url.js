fmd("id2url",["global","event","config"],function(g,c,e){var h=/^https?:\/\//i,k=(new Date).getTime();e.set({baseUrl:function(){var a=/^\w+\:\/\/[\w\-\.:]+\//i,b=g.document.getElementsByTagName("script"),b=b[b.length-1];return(a=(b=b.hasAttribute?b.src:b.getAttribute("src",4))?b.match(a):null)?a[0]:""}()});e.register({keys:"resolve",name:"array"}).register({keys:"stamp",name:"object"});c.on("resolve",function(a){var b=e.get("resolve"),d;if(b)for(var f=0,c=b.length;f<c&&(d=b[f](a.id),d===a.id);f++);
a.url=d?d:a.id});c.on("stamp",function(a){var b=e.get("hasStamp")?k:null,d=e.get("stamp");if(d)for(var c in d)if(RegExp(c).test(a.id)){b=d[c];break}b&&(a.url+="?fmd.stamp="+b)});c.on("id2url",function(a){c.emit("resolve",a);h.test(a.url)||(a.url=e.get("baseUrl")+a.url);var b=a.url;b.lastIndexOf(".")<b.lastIndexOf("/")&&(a.url+=".js");c.emit("stamp",a)})});
